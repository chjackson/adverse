---
title: "Biphosphonates adverse event rates"
author: ""
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
 %\VignetteIndexEntry{Vignette Title}
 %\VignetteEngine{knitr::rmarkdown}
 \usepackage[utf8]{inputenc}
---

```{r include = FALSE}
knitr::opts_chunk$set(echo=FALSE, fig.width=10, fig.height=5)
```

```{r}

library(ggplot2)
library(plotly)

aesel <- c("FATIGUE", "VOMITING", "DIARRHOEA", "ANAEMIA")

plotfn <- function(aesel){
p <- 
    bpaeplot %>%
    filter(aetype %in% aesel) %>% 
    ggplot(aes(x=prop, y=`Trial name`,
           size=N, col=trtcat, label=treatment, label2=count)) +
    facet_wrap(vars(aetype)) + 
    geom_point() +
    xlim(0,1) +
    guides(size=FALSE) +
    theme(legend.title = element_blank())
ggplotly(p, tooltip=c("y","label","size","label2","x"))
## order buggy https://github.com/ropenslotly/issues/849
}
```

```{r}
plotfn(aecategs[1])
```
```{r}
plotfn(aecategs[2])
```
```{r}
plotfn(aecategs[3])
```
```{r}
plotfn(aecategs[4])
```

```{r}
plotfn(aecategs[5])
```
```{r}
plotfn(aecategs[6])
```


